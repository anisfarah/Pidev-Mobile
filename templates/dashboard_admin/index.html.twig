{% extends 'baseBack.html.twig' %}
{% block title %}
	Dashboard
{% endblock %}
{% block body %}
	<h4 class="page-title">Dashboard Admin</h4>
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-6 col-xl-3">
				<div class="card-box">
					<i class="fa fa-info-circle text-muted float-right" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Factures"></i>
					<h4 class="mt-0 font-16">Nombre des factures</h4>
					<h2 class="text-primary my-3 text-center">
						<span data-plugin="counterup">{{nbFacture}}</span>
					</h2>
				</div>
			</div>

			<div class="col-md-6 col-xl-3">
				<div class="card-box">
					<i class="fa fa-info-circle text-muted float-right" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Users"></i>
					<h4 class="mt-0 font-16">Nombre des utilisateurs</h4>
					<h2 class="text-primary my-3 text-center">
						<span data-plugin="counterup">{{nbUser}}</span>
					</h2>
				</div>
			</div>

			<div class="col-md-6 col-xl-3">
				<div class="card-box">
					<i class="fa fa-info-circle text-muted float-right" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Demandes acceptées"></i>
					<h4 class="mt-0 font-16">Nombre des livres</h4>
					<h2 class="text-primary my-3 text-center">
						<span data-plugin="counterup">
							{{nbLivre}}
						</span>
					</h2>
				</div>
			</div>

			<div class="col-md-6 col-xl-3">
				<div class="card-box">
					<i class="fa fa-info-circle text-muted float-right" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="Events"></i>
					<h4 class="mt-0 font-16">Nombre des Events</h4>
					<h2 class="text-primary my-3 text-center">
						<span data-plugin="counterup">{{nbEvents}}</span>
					</h2>
				</div>
			</div>
		</div>
		<!-- end row -->
		<div class="row d-flex">
			<div class="col-xl-6 flex-grow-1">
				<div class="card">
					<div class="card-body">
						<div class="card-widgets">
							<a href="javascript: void(0);" data-toggle="reload">
								<i class="mdi mdi-refresh"></i>
							</a>
							<a data-toggle="collapse" href="#cardCollpase8" role="button" aria-expanded="false" aria-controls="cardCollpase8">
								<i class="mdi mdi-minus"></i>
							</a>
							<a href="javascript: void(0);" data-toggle="remove">
								<i class="mdi mdi-close"></i>
							</a>
						</div>

						<h4 class="header-title mb-0">Factures par client</h4>

						<div id="factu_clt" style="height: 300px" data-colors="#f4f8fb,#4a81d4,#1abc9c" dir="ltr"></div>
					</div>
				</div>
			</div>

			<div class="col-xl-6 flex-grow-1">
				<div class="card">
					<div class="card-body">
						<h4 class="header-title mb-0">Livres les plus achetés</h4>
						<div id="chart_bestSelling" style="height: 300px;" data-colors="#f4f8fb,#4a81d4,#1abc9c" dir="ltr"></div>


					</div>
				</div>
			</div>

			<!-- collapsed end -->
		</div>
		<div class="row d-flex">
			<div class="col-xl-6 flex-grow-1">
				<div class="card">
					<div class="card-body">
						<div class="card-widgets">
							<a href="javascript: void(0);" data-toggle="reload">
								<i class="mdi mdi-refresh"></i>
							</a>
							<a data-toggle="collapse" href="#cardCollpase8" role="button" aria-expanded="false" aria-controls="cardCollpase8">
								<i class="mdi mdi-minus"></i>
							</a>
							<a href="javascript: void(0);" data-toggle="remove">
								<i class="mdi mdi-close"></i>
							</a>
						</div>

						<h4 class="header-title mb-0">Livres par catégorie</h4>

						<div id="livre_cat" style="height: 300px" data-colors="#f4f8fb,#4a81d4,#1abc9c" dir="ltr"></div>

					</div>
				</div>
			</div>

			<div class="col-xl-6 flex-grow-1">
				<div class="card">
					<div class="card-body">
						<h4 class="header-title mb-0">Livres les moins chers</h4>
						<div id="livre_moinsCher" style="height: 300px;" data-colors="#f4f8fb,#4a81d4,#1abc9c" dir="ltr"></div>


					</div>
				</div>
			</div>

			<!-- collapsed end -->
		</div>
		<!-- end card-body -->
	</div>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script>
		var getData = $.get('{{ path('factures_by_user') }}')
getData.done(function (results) {
var options = {
series: [
{
name: "Nombre",
data: results.result.map(function (item) {
return item.num_factures
})
}
],
chart: {
type: 'bar',
height: 350
},
plotOptions: {
bar: {
borderRadius: 4,
horizontal: true
}
},
dataLabels: {
enabled: false
},
xaxis: {
categories: results.result.map(function (item) {
return item.prenom + " " + item.nom
})
}
};
var chart = new ApexCharts(document.querySelector("#factu_clt"), options);
chart.render();
});

// chart 2
var getData = $.get('{{ path('factures_bestselling') }}')
getData.done(function (results) {
var data = [];
var categories = [];

for (var i = 0; i < 5; i++) {
data.push(results.result[i].nb_factures);
categories.push(results.result[i].libelle);
}

var colors = ["rgb(119, 93, 208)", "rgb(0, 227, 150)", "rgb(0, 143, 251)", "rgb(255, 69, 96)"];

var options = {
series: [
{
name: "Nombre",
data: data
}
],
chart: {
height: 350,
type: 'bar',
events: {
click: function (chart, w, e) {}
}
},
colors: colors,
plotOptions: {
bar: {
columnWidth: '45%',
distributed: true
}
},
dataLabels: {
enabled: false
},
legend: {
show: false
},
xaxis: {
categories: categories,
labels: {
style: {
colors: colors,
fontSize: '12px'
}
}
}
};

var chart = new ApexCharts(document.querySelector("#chart_bestSelling"), options);
chart.render();
})

var getData = $.get('{{ path('livres_by_categorie') }}')
getData.done(function (results) {
var options = {
series: [
{
name: "Nombre",
data: results.result.map(function (item) {
return item.num_categories
})
}
],
chart: {
type: 'bar',
height: 350
},
plotOptions: {
bar: {
borderRadius: 4,
horizontal: true
}
},
dataLabels: {
enabled: false
},
xaxis: {
categories: results.result.map(function (item) {
return item.categorie
})
}
};
var chart = new ApexCharts(document.querySelector("#livre_cat"), options);
chart.render();
});
// chart 2
var getData = $.get('{{ path('livres_moins_cher') }}')
getData.done(function (results) {
var data = [];
var categories = [];
for (var i = 0; i < 5; i++) {
data.push(results.result[i].prix);
categories.push(results.result[i].libelle);
}
var colors = ["rgb(119, 93, 208)", "rgb(0, 227, 150)", "rgb(0, 143, 251)", "rgb(255, 69, 96)"];
var options = {
series: [
{
name: "Nombre",
data: data
}
],
chart: {
height: 350,
type: 'bar',
events: {
click: function (chart, w, e) {}
}
},
colors: colors,
plotOptions: {
bar: {
columnWidth: '45%',
distributed: true
}
},
dataLabels: {
enabled: false
},
legend: {
show: false
},
xaxis: {
categories: categories,
labels: {
style: {
colors: colors,
fontSize: '12px'
}
}
}
};
var chart = new ApexCharts(document.querySelector("#livre_moinsCher"), options);
chart.render();
})
	</script>
{% endblock %}
